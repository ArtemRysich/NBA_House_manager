{"mappings":"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","sources":["src/realty.js","src/services/collection/addToCollection.js"],"sourcesContent":["import * as basicLightbox from 'basiclightbox';\nimport '../node_modules/basiclightbox/dist/basicLightbox.min.css';\nimport { addToCollection } from './services/collection/addToCollection';\nimport { getCollection } from './services/collection/getCollection';\n\nconst addRealtyBtn = document.querySelector('.js-add-realty');\nconst realtyItems = [];\nconst list = document.querySelector('.js-list');\nconst logout = document.querySelector('.js-logout');\nlet img = null;\naddRealtyBtn.addEventListener('click', onClick);\nlist.addEventListener('click', cardHandler);\nlogout.addEventListener('click', handlerLogout);\nfunction handlerLogout() {\n  localStorage.clear();\n  location.href = './index.html';\n}\nconst filter = document.querySelector('.js-filter');\nconst filterRemoveBtn = document.querySelector('.js-filter-items-remove');\n\nfilterRemoveBtn.addEventListener('click', handlerRemoveFilter);\nfilter.addEventListener('submit', handlerAddFilter);\n\nfunction handlerAddFilter(evt) {\n  evt.preventDefault();\n  const { filter } = evt.currentTarget.elements;\n  const filteredItems = realtyItems.filter(\n    ({ status }) => status === filter.value\n  );\n  list.innerHTML = createMarkup(filteredItems);\n}\n\nfunction handlerRemoveFilter() {\n  filter.reset();\n  getCollection().then(data => {\n    if (!data.length) {\n      return;\n    }\n    list.insertAdjacentHTML('beforeend', createMarkup(realtyItems));\n  });\n}\nfunction onClick() {\n  const instance = basicLightbox.create(\n    `\n    <form action=\"submit\" class=\"js-form-realty form-realty\">\n\n    <div class='form-realty__input-block form-realty__input-block_row'>\n      <label for=\"photo\" class='form-realty__label'>Завантажте фото об'єкту*</label>\n      <label for=\"photo\" class='form-realty__image-btn'></label>\n      <input type=\"file\" name=\"realty-photo\" id=\"photo\" accept=\"image/png, image/jpeg\" hidden required>\n    </div>\n\n    <div class=\"js-form-realty__preview form-realty__preview\"></div>\n\n    <div class='form-realty__input-block'>\n    <label for=\"text\" class='form-realty__label'>Назва вашого об'єкта*</label>\n    <input type=\"text\" class='form-realty__input' name=\"realty-title\" id=\"title\" required>\n    </div>\n\n    <div class='form-realty__input-block'>\n      <label for=\"details\" class='form-realty__label'>Опис об'єкту*</label>\n      <textarea class='form-realty__input' name=\"realty-details\" id=\"details\" required></textarea>\n    </div>\n\n    <div class='form-realty__input-block'>\n      <label for=\"rooms\" class='form-realty__label'>Кількість кімнат*</label>\n      <input type=\"number\" class='form-realty__input' min=\"0\" name=\"realty-rooms\" id=\"rooms\" required>\n    </div>\n\n    <div class='form-realty__input-block'>\n      <label for=\"area\" class='form-realty__label'>Площа об'єкту м<sup>2</sup>*</label>\n      <input type=\"number\" class='form-realty__input' min=\"0\" name=\"realty-area\" id=\"area\" required>\n    </div>\n\n    <div class='form-realty__input-block'>\n      <label for=\"price\" class='form-realty__label'>Вартість об'єкту*</label>\n      <input type=\"number\" class='form-realty__input' min=\"0\" name=\"realty-price\" id=\"price\" required>\n    </div>\n\n    <div class='form-realty__input-block'>\n      <label for=\"type\" class='form-realty__label'>Тип пропозиції*</label>\n      <select name=\"realty-type\" id=\"type\" class='form-realty__select' required>\n        <option value=\"Оренда\">Оренда</option>\n        <option value=\"Продаж\">Продаж</option>\n      </select>\n    </div>\n    <button class='form-realty__create'>Створити об'єкт</button>\n  </form>`,\n    {\n      onShow: () => {\n        document.body.classList.add('lock');\n      },\n      onClose: () => {\n        document.body.classList.remove('lock');\n      },\n    }\n  );\n\n  instance.show();\n\n  const form = document.querySelector('.js-form-realty');\n  form.addEventListener('submit', addRealty.bind(instance));\n  form.photo.addEventListener('change', onLoad);\n}\n\nfunction cardHandler(evt) {\n  if (!evt.target.closest('.js-realty-item')) {\n    return;\n  }\n  const { id } = evt.target.closest('.js-realty-item').dataset;\n  const { title, photo, details, price, area, rooms, type, status } =\n    realtyItems.find(({ id: currentId }) => currentId === Number(id));\n  const instance =\n    basicLightbox.create(`<div data-id=\"${id}\" class='manage-popup'>\n  <div class='manage-popup__image'>\n    <img src=\"${photo}\" alt=\"${title}\">\n  </div>\n  <h2 class='manage-popup__title'>${title}</h2>\n  <h3 class='manage-popup__details'>${details}</h3>\n  <h3 class='manage-popup__price'>Ціна: ${price} $</h3>\n  <h3 class='manage-popup__square>Площа: ${area} м<sup>2</sup></h3>\n  <h3 class='manage-popup__numbers'>Кількість кімнат: ${rooms}</h3>\n  <h3 class='manage-popup__type'>Тип: ${type}</h3>\n  <h3 class='manage-popup__status'>Статус: ${status}</h3>\n  <button class=\"js-realty-info manage-popup__button\">Управління об'єктом</button>\n  </div>`);\n  instance.show();\n\n  const infoBtn = document.querySelector('.js-realty-info');\n  infoBtn.addEventListener('click', handlerRedirectMode.bind({ id }));\n}\n\nfunction onLoad() {\n  renderImage(this.files[0]);\n}\n\nfunction handlerRedirectMode() {\n  window.location.href = './manageItem.html?id=' + this.id;\n}\n\nfunction renderImage(file) {\n  const container = document.querySelector('.js-form-realty__preview');\n  const reader = new FileReader();\n\n  reader.onload = function (event) {\n    img = event.target.result;\n    container.innerHTML = `<img src=\"${img}\" alt=\"preview\">`;\n  };\n\n  reader.readAsDataURL(file);\n}\nfunction addRealty(evt) {\n  evt.preventDefault();\n  const { details, rooms, area, price, type, title } =\n    evt.currentTarget.elements;\n\n  const data = {\n    photo: img,\n    title: title.value,\n    details: details.value,\n    rooms: rooms.value,\n    area: area.value,\n    price: price.value,\n    type: type.value,\n    status: type.value === 'Продаж' ? 'В продажі' : 'Вільно',\n  };\n  addToCollection(data)\n    .then(resp => {\n      realtyItems.push(resp);\n      list.insertAdjacentHTML('beforeend', createMarkup(realtyItems));\n    })\n    .catch(err => console.log(err));\n  this.close();\n}\n\n(function () {\n  getCollection().then(data => {\n    if (!data.length) {\n      return;\n    }\n    realtyItems.push(...data);\n    list.insertAdjacentHTML('beforeend', createMarkup(realtyItems));\n  });\n})();\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({ status, id, photo, price, area, title, type }) => `\n      <li data-id=\"${id}\" class=\"js-realty-item main-objects__item\">\n        <div class='main-objects__body'>\n          <div class='main-objects__image'>\n            <img src=\"${photo}\" alt=\"${price}\">\n          </div>\n          <div class='main-objects__desc'>\n            <h2 class='main-objects__title'>${title}</h2>\n            <h3 class='main-objects__price'>Ціна: ${price}$</h3>\n            <h3 class='main-objects__square'>Площа: ${area} м<sup>2</sup></h3>\n            <h3 class='main-objects__status'>Статус: ${status}</h3>\n          </div>\n        </div>\n    </li>`\n    )\n    .join('');\n}\n","async function addToCollection(data) {\n  const token = localStorage.getItem('Token');\n  const options = {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: `Bearer ${token}`,\n    },\n  };\n  const resp = await fetch(\n    'https://nba-house-manager.herokuapp.com/objrent/create/',\n    options\n  );\n  if (!resp.ok) {\n    throw new Error('Invalid password');\n  }\n\n  return resp.json();\n}\n\nexport { addToCollection };\n"],"names":["$9B8F0","parcelRequire","async","$f22548f0e395c151$export$fe33f556c78278ee","data","token","localStorage","getItem","options","method","body","JSON","stringify","headers","Authorization","resp","fetch","ok","Error","json","$6b67e4a08e7ccb3f$var$addRealtyBtn","document","querySelector","$6b67e4a08e7ccb3f$var$realtyItems","$6b67e4a08e7ccb3f$var$list","$6b67e4a08e7ccb3f$var$logout","$6b67e4a08e7ccb3f$var$img","addEventListener","instance","create","onShow","classList","add","onClose","remove","show","form","$6b67e4a08e7ccb3f$var$addRealty","bind","photo","$6b67e4a08e7ccb3f$var$onLoad","evt","target","closest","id","dataset","title","details","price","area","rooms","type","status","find","currentId","Number","$6b67e4a08e7ccb3f$var$handlerRedirectMode","clear","location","href","$6b67e4a08e7ccb3f$var$filter","file","container","reader","FileReader","onload","event","result","innerHTML","readAsDataURL","$6b67e4a08e7ccb3f$var$renderImage","this","files","window","preventDefault","currentTarget","elements","value","then","push","insertAdjacentHTML","$6b67e4a08e7ccb3f$var$createMarkup","catch","err","console","log","close","arr","map","join","reset","$8HGhi","getCollection","length","filter","filter1","filteredItems"],"version":3,"file":"realty.a243fa7c.js.map"}