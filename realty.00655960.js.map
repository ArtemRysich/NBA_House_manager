{"mappings":"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","sources":["src/realty.js","src/services/collection/addToCollection.js"],"sourcesContent":["import * as basicLightbox from 'basiclightbox';\nimport '../node_modules/basiclightbox/dist/basicLightbox.min.css';\nimport { addToCollection } from './services/collection/addToCollection';\n\nconst addRealtyBtn = document.querySelector('.js-add-realty');\nconst realtyItems = [];\nconst list = document.querySelector('.js-list');\nlet img = null;\naddRealtyBtn.addEventListener('click', onClick);\nlist.addEventListener('click', cardHandler);\n\nconst filter = document.querySelector('.js-filter');\nconst filterRemoveBtn = document.querySelector('.js-filter-items-remove');\n\nfilterRemoveBtn.addEventListener('click', handlerRemoveFilter);\nfilter.addEventListener('submit', handlerAddFilter);\n\nfunction handlerAddFilter(evt) {\n  evt.preventDefault();\n  const { filter } = evt.currentTarget.elements;\n  const filteredItems = realtyItems.filter(\n    ({ status }) => status === filter.value\n  );\n  list.innerHTML = createMarkup(filteredItems);\n}\n\nfunction handlerRemoveFilter() {\n  filter.reset();\n  list.innerHTML = createMarkup(realtyItems);\n}\nfunction onClick() {\n  const instance = basicLightbox.create(\n    `\n    <form action=\"submit\" class=\"js-form-realty form-realty\">\n\n    <div class='form-realty__input-block form-realty__input-block_row'>\n      <label for=\"photo\" class='form-realty__label'>Завантажте фото об'єкту*</label>\n      <label for=\"photo\" class='form-realty__image-btn'></label>\n      <input type=\"file\" name=\"realty-photo\" id=\"photo\" accept=\"image/png, image/jpeg\" hidden required>\n    </div>\n\n    <div class=\"js-form-realty__preview form-realty__preview\"></div>\n\n    <div class='form-realty__input-block'>\n    <label for=\"text\" class='form-realty__label'>Назва вашого об'єкта*</label>\n    <input type=\"text\" class='form-realty__input' name=\"realty-title\" id=\"title\" required>\n    </div>\n\n    <div class='form-realty__input-block'>\n      <label for=\"details\" class='form-realty__label'>Опис об'єкту*</label>\n      <textarea class='form-realty__input' name=\"realty-details\" id=\"details\" required></textarea>\n    </div>\n\n    <div class='form-realty__input-block'>\n      <label for=\"rooms\" class='form-realty__label'>Кількість кімнат*</label>\n      <input type=\"number\" class='form-realty__input' min=\"0\" name=\"realty-rooms\" id=\"rooms\" required>\n    </div>\n\n    <div class='form-realty__input-block'>\n      <label for=\"area\" class='form-realty__label'>Площа об'єкту м<sup>2</sup>*</label>\n      <input type=\"number\" class='form-realty__input' min=\"0\" name=\"realty-area\" id=\"area\" required>\n    </div>\n\n    <div class='form-realty__input-block'>\n      <label for=\"price\" class='form-realty__label'>Вартість об'єкту*</label>\n      <input type=\"number\" class='form-realty__input' min=\"0\" name=\"realty-price\" id=\"price\" required>\n    </div>\n\n    <div class='form-realty__input-block'>\n      <label for=\"type\" class='form-realty__label'>Тип пропозиції*</label>\n      <select name=\"realty-type\" id=\"type\" class='form-realty__select' required>\n        <option value=\"Оренда\">Оренда</option>\n        <option value=\"Продаж\">Продаж</option>\n      </select>\n    </div>\n    <button class='form-realty__create'>Створити об'єкт</button>\n  </form>`,\n    {\n      onShow: () => {\n        document.body.classList.add('lock');\n      },\n      onClose: () => {\n        document.body.classList.remove('lock');\n      },\n    }\n  );\n\n  instance.show();\n\n  const form = document.querySelector('.js-form-realty');\n  form.addEventListener('submit', addRealty.bind(instance));\n  form.photo.addEventListener('change', onLoad);\n}\n\nfunction cardHandler(evt) {\n  if (!evt.target.closest('.js-realty-item')) {\n    return;\n  }\n  const { id } = evt.target.closest('.js-realty-item').dataset;\n  console.log(id);\n  const { title, photo, details, price, area, rooms, type, status } =\n    realtyItems.find(({ id: currentId }) => currentId === Number(id));\n  const instance =\n    basicLightbox.create(`<div data-id=\"${id}\" class='manage-popup'>\n  <div class='manage-popup__image'>\n    <img src=\"${photo}\" alt=\"${title}\">\n  </div>\n  <h2 class='manage-popup__title'>${title}</h2>\n  <h3 class='manage-popup__details'>${details}</h3>\n  <h3 class='manage-popup__price'>Ціна: ${price} $</h3>\n  <h3 class='manage-popup__square>Площа: ${area} м<sup>2</sup></h3>\n  <h3 class='manage-popup__numbers'>Кількість кімнат: ${rooms}</h3>\n  <h3 class='manage-popup__type'>Тип: ${type}</h3>\n  <h3 class='manage-popup__status'>Статус: ${status}</h3>\n  <button class=\"js-realty-info manage-popup__button\">Управління об'єктом</button>\n  </div>`);\n  instance.show();\n\n  const infoBtn = document.querySelector('.js-realty-info');\n  infoBtn.addEventListener('click', handlerRedirectMode.bind({ id }));\n}\n\nfunction onLoad() {\n  renderImage(this.files[0]);\n}\n\nfunction handlerRedirectMode() {\n  window.location.href = './manageItem.html?id=' + this.id;\n}\n\nfunction renderImage(file) {\n  const container = document.querySelector('.js-form-realty__preview');\n  const reader = new FileReader();\n\n  reader.onload = function (event) {\n    img = event.target.result;\n    container.innerHTML = `<img src=\"${img}\" alt=\"preview\">`;\n  };\n\n  reader.readAsDataURL(file);\n}\nfunction addRealty(evt) {\n  evt.preventDefault();\n  const { details, rooms, area, price, type, title } =\n    evt.currentTarget.elements;\n\n  const data = {\n    photo: img,\n    title: title.value,\n    details: details.value,\n    rooms: rooms.value,\n    area: area.value,\n    price: price.value,\n    type: type.value,\n    status: type.value === 'Продаж' ? 'В продажі' : 'Вільно',\n  };\n  console.log(data);\n  addToCollection(data)\n    .then(resp => {\n      realtyItems.push(resp);\n      list.insertAdjacentHTML('beforeend', createMarkup(realtyItems));\n    })\n    .catch(err => console.log(err));\n  this.close();\n}\n\n(function () {\n  if (!realtyItems.length) {\n    return;\n  }\n  list.insertAdjacentHTML('beforeend', createMarkup(realtyItems));\n})();\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({ status, id, photo, price, area, title, type }) => `\n      <li data-id=\"${id}\" class=\"js-realty-item main-objects__item\">\n        <div class='main-objects__body'>\n          <div class='main-objects__image'>\n            <img src=\"${photo}\" alt=\"${price}\">\n          </div>\n          <div class='main-objects__desc'>\n            <h2 class='main-objects__title'>${title}</h2>\n            <h3 class='main-objects__price'>Ціна: ${price}$</h3>\n            <h3 class='main-objects__square'>Площа: ${area} м<sup>2</sup></h3>\n            <h3 class='main-objects__status'>Статус: ${status}</h3>\n          </div>\n        </div>\n    </li>`\n    )\n    .join('');\n}\n","async function addToCollection(data) {\n  const token = localStorage.getItem('Token');\n  const options = {\n    method: 'POST',\n    body: JSON.stringify(data),\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: `Bearer ${token}`,\n    },\n  };\n  const resp = await fetch(\n    'https://nba-house-manager.herokuapp.com/objrent/create/',\n    options\n  );\n  if (!resp.ok) {\n    throw new Error('Invalid password');\n  }\n  console.log('resp', resp);\n  return resp.json();\n}\n\nexport { addToCollection };\n"],"names":["$dyT35","parcelRequire","$bpxeT","$099768cf92363d9b$export$fe33f556c78278ee","data","$099768cf92363d9b$var$_addToCollection","apply","this","arguments","$parcel$interopDefault","$2TvXO","mark","_callee","token","options","resp","localStorage","getItem","method","body","JSON","stringify","headers","Authorization","concat","fetch","_ctx","sent","ok","Error","console","log","json","$8d20cd6b5d69c379$var$addRealtyBtn","document","querySelector","$8d20cd6b5d69c379$var$realtyItems","$8d20cd6b5d69c379$var$list","$8d20cd6b5d69c379$var$img","addEventListener","instance","create","onShow","classList","add","onClose","remove","show","form","$8d20cd6b5d69c379$var$addRealty","bind","photo","$8d20cd6b5d69c379$var$onLoad","evt","target","closest","id","dataset","ref","find","param","Number","title","details","price","area","rooms","type","status","$8d20cd6b5d69c379$var$handlerRedirectMode","$8d20cd6b5d69c379$var$filter","file","container","reader","files","FileReader","onload","event","result","innerHTML","readAsDataURL","window","location","href","preventDefault","_elements","currentTarget","elements","value","then","push","insertAdjacentHTML","$8d20cd6b5d69c379$var$createMarkup","catch","err","close","arr","map","join","reset","filter1","filter","filteredItems","length"],"version":3,"file":"realty.00655960.js.map"}